<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🇯🇵 니혼고챗</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app">
        <!-- 헤더 -->
        <header class="header">
            <button class="header-btn" onclick="clearChat()" title="대화 삭제">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
                </svg>
            </button>
            <h1 class="header-title">🇯🇵 니혼고챗</h1>
            <button class="header-btn" onclick="toggleSettings()" title="설정">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
                </svg>
            </button>
        </header>

        <!-- 채팅 영역 -->
        <main class="chat-container" id="chatContainer">
            <div class="messages" id="messages">
                <!-- 메시지들이 여기에 추가됨 -->
            </div>
        </main>

        <!-- 입력 영역 -->
        <footer class="input-container">
            <div class="input-wrapper">
                <textarea 
                    id="messageInput" 
                    placeholder="메시지를 입력하세요..."
                    rows="1"
                    onkeydown="handleKeyDown(event)"
                ></textarea>
            </div>
            <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                </svg>
            </button>
        </footer>

        <!-- 설정 모달 -->
        <div class="modal-overlay" id="settingsModal" onclick="closeSettingsOnOverlay(event)">
            <div class="modal">
                <div class="modal-header">
                    <h2>⚙️ 설정</h2>
                    <button class="close-btn" onclick="toggleSettings()">×</button>
                </div>
                <div class="modal-body">
                    <!-- API 키 -->
                    <div class="setting-section">
                        <label class="setting-label">🔑 OpenAI API 키</label>
                        <div class="api-key-input">
                            <input type="password" id="apiKey" placeholder="sk-...">
                            <button class="toggle-visibility" onclick="toggleApiKeyVisibility()">
                                <svg id="eyeIcon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                    <circle cx="12" cy="12" r="3"/>
                                </svg>
                            </button>
                        </div>
                        <p class="setting-hint">OpenAI에서 발급받은 API 키를 입력하세요</p>
                    </div>

                    <!-- 대화 상대 이름 -->
                    <div class="setting-section">
                        <label class="setting-label">👤 대화 상대 이름</label>
                        <input type="text" id="partnerName" value="유키" placeholder="유키">
                    </div>

                    <!-- 난이도 -->
                    <div class="setting-section">
                        <label class="setting-label">📚 난이도</label>
                        <div class="segmented-control">
                            <button class="segment active" data-value="beginner" onclick="selectDifficulty(this)">초급</button>
                            <button class="segment" data-value="intermediate" onclick="selectDifficulty(this)">중급</button>
                            <button class="segment" data-value="advanced" onclick="selectDifficulty(this)">고급</button>
                        </div>
                    </div>

                    <!-- 주제 -->
                    <div class="setting-section">
                        <label class="setting-label">💬 대화 주제</label>
                        <div class="topic-grid">
                            <button class="topic-btn active" data-value="free" onclick="selectTopic(this)">자유 대화</button>
                            <button class="topic-btn" data-value="dailyLife" onclick="selectTopic(this)">일상생활</button>
                            <button class="topic-btn" data-value="travel" onclick="selectTopic(this)">여행</button>
                            <button class="topic-btn" data-value="food" onclick="selectTopic(this)">음식</button>
                            <button class="topic-btn" data-value="culture" onclick="selectTopic(this)">문화</button>
                            <button class="topic-btn" data-value="business" onclick="selectTopic(this)">비즈니스</button>
                            <button class="topic-btn" data-value="anime" onclick="selectTopic(this)">애니/만화</button>
                        </div>
                    </div>

                    <!-- 표시 설정 -->
                    <div class="setting-section">
                        <label class="setting-label">🎨 표시 설정</label>
                        <div class="toggle-row">
                            <div class="toggle-info">
                                <span class="toggle-title">번역 보기</span>
                                <span class="toggle-subtitle">AI 메시지를 클릭하면 한국어 번역을 볼 수 있어요</span>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="showTranslation" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="toggle-row">
                            <div class="toggle-info">
                                <span class="toggle-title">후리가나 보기</span>
                                <span class="toggle-subtitle">AI 메시지를 클릭하면 읽는 법을 볼 수 있어요</span>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="showFurigana" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="save-btn" onclick="saveSettings()">저장</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>

